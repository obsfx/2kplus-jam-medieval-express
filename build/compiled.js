'use strict';let d=document.getElementsByTagName("canvas")[0].getContext("2d"),e=Array(100).fill(99),g=["#0FF","#F61677","#FFF","#0F0"],h="00011001000110010011110101000101010101100111010101100100111011100000000000110000101101111011011100000000111111110000000001000010111111111000000110111101101001011011110110111001101111011011110111111111100000011000000110000001100000011000000110000001100000010000000000000000011000101011110100010100000110000000000000000000000000000000000000011010000110100000001000010111001010100110100000100100001111010001100100000010001110010111010101100110111001010001100000100010001110110001101100101010011011000110101011101010000000000010000000110000011100000111000001110000011111001111111100000000000000000001000000111000011011000111011011111011111111110000000000000000001111000001100000011000000110000011110001111110".split(""),
k=[],l={x:0,y:0},p={x:0,y:0,f:1,d:0,a:15,c:0,b:(a,b,c)=>{99==e[10*b+a]?(m(a,b,p,0),p.c&&(1==c&&p.x-2==l.x&&p.y==l.y&&m(p.x-1,p.y,l,1),0==c&&p.x+2==l.x&&p.y==l.y&&m(p.x+1,p.y,l,1),2==c&&p.x==l.x&&p.y+2==l.y&&m(p.x,p.y+1,l,1),3==c&&p.x==l.x&&p.y-2==l.y&&m(p.x,p.y-1,l,1)),t()):k.filter(f=>f.x==a&&f.y==b&&!f.d)[0]?(c=k.filter(f=>f.x==a&&f.y==b)[0].g,(k[c].a-=p.f)?(console.log("a"),console.log(k[c].a)):(console.log("ded"),k[c].d=1,e[10*b+a]=99),t()):1==e[10*b+a]&&(1!=c||99!=e[10*b+a+1]&&2!=e[10*b+a+1]||
(2==e[10*b+a+1]&&console.log("next room"),m(a+1,b,l,1),m(a,b,p,0)),0==c&&99==e[10*b+a-1]&&(m(a-1,b,l,1),m(a,b,p,0)),2==c&&99==e[10*(b-1)+a]&&(m(a,b-1,l,1),m(a,b,p,0)),3==c&&99==e[10*(b+1)+a]&&(m(a,b+1,l,1),m(a,b,p,0)))}},u=(a,b)=>Math.floor(Math.random()*(b-a))+a,v=(a,b,c,f,n)=>{for(let q=b;q<b+f;q++)for(let r=a;r<a+c;r++)e[10*q+r]=n},w=()=>{let a=[];e.map((b,c)=>{99==b&&a.push({x:c%10,y:Math.floor(c/10)})});return a},m=(a,b,c,f)=>{e[10*c.y+c.x]=99;c.x=a;c.y=b;e[10*c.y+c.x]=f},t=()=>{k.map((a,b)=>
{let c=p.x>a.x?1:-1,f=p.y>a.y?1:-1;2<u(0,9)&&!a.d&&(0==e[10*a.y+a.x+c]||0==e[10*(a.y+f)+a.x]?console.log("mob attack"):99==e[10*a.y+a.x+c]&&p.x!=a.x?(e[10*a.y+a.x+c]=e[10*a.y+a.x],e[10*a.y+a.x]=99,k[b].x=a.x+c):99==e[10*(a.y+f)+a.x]&&(e[10*(a.y+f)+a.x]=e[10*a.y+a.x],e[10*a.y+a.x]=99,k[b].y=a.y+f))})};window.onkeydown=a=>{a.repeat||(69==a.keyCode&&(p.c=1),39==a.keyCode?p.b(p.x+1,p.y,1):37==a.keyCode?p.b(p.x-1,p.y,0):38==a.keyCode?p.b(p.x,p.y-1,2):40==a.keyCode&&p.b(p.x,p.y+1,3))};
window.onkeyup=a=>{a.repeat||69!=a.keyCode||(p.c=0)};d.textBaseline="top";d.font="bold 10px monospace";(()=>{v(0,0,10,10,98);v(1,1,8,8,99);var a=w().filter(f=>2<f.x&&7>f.x&&1<f.y&&8>f.y);k=[];for(var b=0;b<u(3,5);b++){var c=a.splice(u(0,a.length),1)[0];e[10*c.y+c.x]=u(8,10)}for(b=0;b<u(1,4);b++)c=a.splice(u(0,a.length),1)[0],e[10*c.y+c.x]=u(4,7),k[k.length]={g:k.length,a:10,k:0,d:0,x:c.x,y:c.y};a=u(1,6);b=u(1,7);e[10*a]=3;e[10*b+9]=2;e[10*a+1]=0;p.x=1;p.y=a;e[10*a+2]=1;l.x=2;l.y=a})();
console.log(p,k);
setInterval(()=>{d.fillStyle="#000";d.fillRect(0,0,500,500);d.fillStyle=g[2];d.fillRect(12,12,216,216);d.fillStyle="#000";d.fillRect(14,14,212,212);e.map((a,b)=>{if(99!=a){var c=g[2];0==a&&(c=g[0]);1==a&&(c=g[3]);3<a&&8>a&&(c=g[1]);if(98!=a){var f=b%10;b=Math.floor(b/10);for(let n=0;64>n;n++)"0"!=h[64*a+n]?d.fillStyle=c:d.fillStyle="#000",d.fillRect(n%8*3+24*f,3*Math.floor(n/8)+24*b,3,3)}}else d.fillStyle="#666",d.fillRect(b%10*24+8,24*Math.floor(b/10)+8,3,3)});k.map(a=>{a.d||(d.fillStyle="#000",
d.fillRect(24*a.x,24*a.y-12,10,10),d.fillStyle="#FF0",d.fillText(a.a,24*a.x,24*a.y-12))})},1E3/30);
