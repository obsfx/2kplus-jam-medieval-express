<body bgcolor="black"><canvas style="border:1px solid #3a3a3a;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);" width="500px" height="500px"></canvas></body><script>let b=document.getElementsByTagName("canvas")[0].getContext("2d"),e=Array(100).fill(99),g=["#0FF","#F61677","#FFF","#0F0"],h="00011001000110010011110101000101010101100111010101100100111011100000000000110000101101111011011100000000111111110000000001000010111111111000000110111101101001011011110110111001101111011011110111111111100000011000000110000001100000011000000110000001100000010000000000000000011000101011110100010100000110000000000000000000000000000000000000011010000110100000001000010111001010100110100000100100001111010001100100000010001110010111010101100110111001010001100000100010001110110001101100101010011011000110101011101010000000000010000000110000011100000111000001110000011111001111111100000000000000000001000000111000011011000111011011111011111111110000000000000000001111000001100000011000000110000011110001111110".split(""),k=[],l=0,n=!1,p=!1,q={x:0,y:0},t={x:0,y:0,f:1,d:0,a:15,b:0,c:(a,c,d)=>{99==e[10*c+a]?(r(a,c,t,0),t.b&&(1==d&&t.x-2==q.x&&t.y==q.y&&r(t.x-1,t.y,q,1),0==d&&t.x+2==q.x&&t.y==q.y&&r(t.x+1,t.y,q,1),2==d&&t.x==q.x&&t.y+2==q.y&&r(t.x,t.y+1,q,1),3==d&&t.x==q.x&&t.y-2==q.y&&r(t.x,t.y-1,q,1)),w()):k.filter(f=>f.x==a&&f.y==c&&!f.d)[0]?(d=k.filter(f=>f.x==a&&f.y==c)[0].g,k[d].a-=t.f,0<k[d].a?(console.log("a"),console.log(k[d].a)):(console.log("ded"),k[d].d=1,e[10*c+a]=99),w()):1==e[10*c+a]&&(1!=d||99!=e[10*c+a+1]&&2!=e[10*c+a+1]||(2==e[10*c+a+1]&&(console.log("next room"),8<++l?(p=!0,b.fillStyle="#000",b.fillRect(0,0,500,500),b.fillStyle="#FF0",b.fillText("Game Over",50,50)):(n=!0,setTimeout(()=>x(++l),250))),r(a+1,c,q,1),r(a,c,t,0)),0==d&&99==e[10*c+a-1]&&(r(a-1,c,q,1),r(a,c,t,0)),2==d&&99==e[10*(c-1)+a]&&(r(a,c-1,q,1),r(a,c,t,0)),3==d&&99==e[10*(c+1)+a]&&(r(a,c+1,q,1),r(a,c,t,0)))}},y=(a,c)=>Math.floor(Math.random()*(c-a))+a,z=(a,c,d,f,m)=>{for(let u=c;u<c+f;u++)for(let v=a;v<a+d;v++)e[10*u+v]=m},A=()=>{let a=[];e.map((c,d)=>{99==c&&a.push({x:d%10,y:Math.floor(d/10)})});return a},r=(a,c,d,f)=>{e[10*d.y+d.x]=99;d.x=a;d.y=c;e[10*d.y+d.x]=f},w=()=>{k.map((a,c)=>{let d=t.x>a.x?1:-1,f=t.y>a.y?1:-1;2<y(0,9)&&!a.d&&(0==e[10*a.y+a.x+d]||0==e[10*(a.y+f)+a.x]?console.log("mob attack"):99==e[10*a.y+a.x+d]&&t.x!=a.x?(e[10*a.y+a.x+d]=e[10*a.y+a.x],e[10*a.y+a.x]=99,k[c].x=a.x+d):99==e[10*(a.y+f)+a.x]&&(e[10*(a.y+f)+a.x]=e[10*a.y+a.x],e[10*a.y+a.x]=99,k[c].y=a.y+f))})},x=a=>{console.log(e);z(0,0,10,10,98);z(1,1,8,8,99);var c=A().filter(m=>2<m.x&&7>m.x&&1<m.y&&8>m.y);k=[];for(var d=0;d<y(3,5);d++){var f=c.splice(y(0,c.length),1)[0];e[10*f.y+f.x]=y(8,10)}for(d=0;d<y(1,4);d++)f=c.splice(y(0,c.length),1)[0],e[10*f.y+f.x]=y(4,7),k[k.length]={g:k.length,a:10,k:0,d:0,x:f.x,y:f.y};a=a?t.y:y(1,8);c=y(1,8);e[10*a]=2;e[10*c+9]=2;e[10*a+1]=0;t.x=1;t.y=a;e[10*a+2]=1;q.x=2;q.y=a;n=!1};window.onkeydown=a=>{a.repeat||n||(69==a.keyCode&&(t.b=1,p&&B()),39==a.keyCode?t.c(t.x+1,t.y,1):37==a.keyCode?t.c(t.x-1,t.y,0):38==a.keyCode?t.c(t.x,t.y-1,2):40==a.keyCode&&t.c(t.x,t.y+1,3))};window.onkeyup=a=>{a.repeat||69!=a.keyCode||(t.b=0)};b.textBaseline="top";b.font="bold 10px monospace";let B=()=>{l=0;p=n=!1;t.f=1;t.d=0;t.a=15;t.b=0;x(l)};B();setInterval(()=>{p||(b.fillStyle="#000",b.fillRect(0,0,500,500),b.fillStyle=g[2],b.fillRect(12,12,216,216),b.fillStyle="#000",b.fillRect(14,14,212,212),e.map((a,c)=>{if(99!=a){var d=g[2];0==a&&(d=g[0]);1==a&&(d=g[3]);3<a&&8>a&&(d=g[1]);if(98!=a){var f=c%10;c=Math.floor(c/10);for(let m=0;64>m;m++)"0"!=h[64*a+m]?b.fillStyle=d:b.fillStyle="#000",b.fillRect(m%8*3+24*f,3*Math.floor(m/8)+24*c,3,3)}}else b.fillStyle="#666",b.fillRect(c%10*24+8,24*Math.floor(c/10)+8,3,3)}))},1E3/30);</script>