<body bgcolor="black"><canvas style="border:1px solid #3a3a3a;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);" width="500px" height="500px"></canvas></body><script>let c=document.getElementsByTagName("canvas")[0].getContext("2d"),e=Array(100).fill(99),g=["#0BF8F1","#F61677","#FFF"],h="00011001000110010011110101000101010101100111010101100100111011100000000000110000101101111011011100000000111111110000000001000010111111111000000110111101101001011011110110111001101111011011110111111111100000011000000110000001100000011000000110000001100000010000000000000000011000101011110100010100000110000000000000000000000000000000000000011010000110100000001000010111001010100110100000100100001111010001100100000010001110010111010101100110111001010001100000100010001110110001101100101010011011000110101011101010000000000010000000110000011100000111000001110000011111001111111100000000000000000001000000111000011011000111011011111011111111110000000000000000001111000001100000011000000110000011110001111110000000000011111100010001001100010011000100110001001100010011111111100111101001011000000110000001100000010100001001000010001111000000000000010001000011100000110000010010011000001000000000000000000010000001011000010001001000100010001001000100011001000001100000000000000000000001110000001000000111000001110000011100000000000000100000010100000101000000100000001000000010000000110000000000".split(""),k={c:{x:0,y:0},b:{x:0,y:0},a:[]},m=[],q={x:0,y:0,a:(a,b)=>{99==e[10*b+a]?(q.f(a,b),r()):m.filter(d=>d.x==a&&d.y==b)[0]&&console.log("attack")},f:(a,b)=>{e[10*q.y+q.x]=99;q.x=a;q.y=b;e[10*q.y+q.x]=0}},t=(a,b)=>Math.floor(Math.random()*(b-a))+a,u=(a,b,d,f,l)=>{for(let n=b;n<b+f;n++)for(let p=a;p<a+d;p++)e[10*n+p]=l},v=()=>{let a=[];e.map((b,d)=>{99==b&&a.push({x:d%10,y:Math.floor(d/10)})});return a},r=()=>{m.map((a,b)=>{let d=q.x>a.x?1:-1,f=q.y>a.y?1:-1;2<t(0,9)&&(0==e[10*a.y+a.x+d]||0==e[10*(a.y+f)+a.x]?console.log("mob attack"):99==e[10*a.y+a.x+d]&&q.x!=a.x?(e[10*a.y+a.x+d]=e[10*a.y+a.x],e[10*a.y+a.x]=99,m[b].x=a.x+d):99==e[10*(a.y+f)+a.x]&&(e[10*(a.y+f)+a.x]=e[10*a.y+a.x],e[10*a.y+a.x]=99,m[b].y=a.y+f))})};window.onkeydown=a=>{a.repeat||(39==a.keyCode?q.a(q.x+1,q.y):37==a.keyCode?q.a(q.x-1,q.y):38==a.keyCode?q.a(q.x,q.y-1):40==a.keyCode&&q.a(q.x,q.y+1))};(()=>{u(0,0,10,10,98);u(1,1,8,8,99);var a=v().filter(f=>1<f.x&&8>f.x&&1<f.y&&8>f.y);for(var b=0;b<t(3,5);b++){var d=a.splice(t(0,a.length),1)[0];e[10*d.y+d.x]=t(8,10)}for(b=0;b<t(1,4);b++)d=a.splice(t(0,a.length),1)[0],e[10*d.y+d.x]=t(4,7),m[m.length]={h:m.length,g:10,k:0,x:d.x,y:d.y};a=t(1,7);b=t(1,7);e[10*a]=3;e[10*b+9]=2;e[10*a+1]=0;q.x=1;q.y=a;k={c:{x:0,y:a},b:{x:9,y:b},a:e}})();let w=()=>{c.fillStyle="#000";c.fillRect(0,0,500,500);c.fillStyle=g[2];c.fillRect(12,12,216,216);c.fillStyle="#000";c.fillRect(14,14,212,212);k.a.map((a,b)=>{if(99!=a){var d=g[2];if(0==a||1==a)d=g[0];3<a&&8>a&&(d=g[1]);if(98!=a){var f=b%10;b=Math.floor(b/10);for(let l=0;64>l;l++)"0"!=h[64*a+l]?c.fillStyle=d:c.fillStyle="#000",c.fillRect(l%8*3+24*f,3*Math.floor(l/8)+24*b,3,3)}}else c.fillStyle="#666",c.fillRect(b%10*24+8,24*Math.floor(b/10)+8,3,3)});requestAnimationFrame(w)};console.log(q,m);w();</script>